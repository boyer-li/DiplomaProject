{"remainingRequest":"H:\\ideahome\\diploma\\diploma-mobile\\node_modules\\babel-loader\\lib\\index.js!H:\\ideahome\\diploma\\diploma-mobile\\src\\view\\goods\\goods.js?vue&type=script&lang=js&","dependencies":[{"path":"H:\\ideahome\\diploma\\diploma-mobile\\src\\view\\goods\\goods.js","mtime":1682865375037},{"path":"H:\\ideahome\\diploma\\diploma-mobile\\babel.config.js","mtime":1680357703151},{"path":"H:\\ideahome\\diploma\\diploma-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1682170151740},{"path":"H:\\ideahome\\diploma\\diploma-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":1682170152097}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"H:/ideahome/diploma/diploma-mobile/node_modules/@babel/runtime/helpers/interopRequireDefault.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nrequire(\"vant/es/toast/style\");\nvar _toast = _interopRequireDefault(require(\"vant/es/toast\"));\nrequire(\"core-js/modules/es6.regexp.split\");\nvar _defineProperty2 = _interopRequireDefault(require(\"H:/ideahome/diploma/diploma-mobile/node_modules/@babel/runtime/helpers/defineProperty.js\"));\nrequire(\"vant/es/button/style\");\nvar _button = _interopRequireDefault(require(\"vant/es/button\"));\nrequire(\"vant/es/sku/style\");\nvar _sku = _interopRequireDefault(require(\"vant/es/sku\"));\nrequire(\"vant/es/tabbar-item/style\");\nvar _tabbarItem = _interopRequireDefault(require(\"vant/es/tabbar-item\"));\nrequire(\"vant/es/tabbar/style\");\nvar _tabbar = _interopRequireDefault(require(\"vant/es/tabbar\"));\nrequire(\"vant/es/goods-action-button/style\");\nvar _goodsActionButton = _interopRequireDefault(require(\"vant/es/goods-action-button\"));\nrequire(\"vant/es/goods-action-icon/style\");\nvar _goodsActionIcon = _interopRequireDefault(require(\"vant/es/goods-action-icon\"));\nrequire(\"vant/es/goods-action/style\");\nvar _goodsAction = _interopRequireDefault(require(\"vant/es/goods-action\"));\nrequire(\"vant/es/swipe-item/style\");\nvar _swipeItem = _interopRequireDefault(require(\"vant/es/swipe-item\"));\nrequire(\"vant/es/swipe/style\");\nvar _swipe = _interopRequireDefault(require(\"vant/es/swipe\"));\nrequire(\"vant/es/cell-group/style\");\nvar _cellGroup = _interopRequireDefault(require(\"vant/es/cell-group\"));\nrequire(\"vant/es/cell/style\");\nvar _cell = _interopRequireDefault(require(\"vant/es/cell\"));\nrequire(\"vant/es/icon/style\");\nvar _icon = _interopRequireDefault(require(\"vant/es/icon\"));\nrequire(\"vant/es/col/style\");\nvar _col = _interopRequireDefault(require(\"vant/es/col\"));\nrequire(\"vant/es/tag/style\");\nvar _tag = _interopRequireDefault(require(\"vant/es/tag\"));\nvar _goods = _interopRequireDefault(require(\"@/api/goods\"));\nvar _cart = _interopRequireDefault(require(\"@/api/cart\"));\nvar _favorite = _interopRequireDefault(require(\"@/api/favorite\"));\nvar _storage = _interopRequireDefault(require(\"@/utils/storage\"));\nvar _components;\nvar baseApi = process.env.VUE_APP_BASE_API;\nvar _default = {\n  components: (_components = {}, (0, _defineProperty2.default)(_components, _tag.default.name, _tag.default), (0, _defineProperty2.default)(_components, _col.default.name, _col.default), (0, _defineProperty2.default)(_components, _icon.default.name, _icon.default), (0, _defineProperty2.default)(_components, _cell.default.name, _cell.default), (0, _defineProperty2.default)(_components, _cellGroup.default.name, _cellGroup.default), (0, _defineProperty2.default)(_components, _swipe.default.name, _swipe.default), (0, _defineProperty2.default)(_components, _swipeItem.default.name, _swipeItem.default), (0, _defineProperty2.default)(_components, _goodsAction.default.name, _goodsAction.default), (0, _defineProperty2.default)(_components, _goodsActionIcon.default.name, _goodsActionIcon.default), (0, _defineProperty2.default)(_components, _goodsActionButton.default.name, _goodsActionButton.default), (0, _defineProperty2.default)(_components, _tabbar.default.name, _tabbar.default), (0, _defineProperty2.default)(_components, _tabbarItem.default.name, _tabbarItem.default), (0, _defineProperty2.default)(_components, _sku.default.name, _sku.default), (0, _defineProperty2.default)(_components, _button.default.name, _button.default), _components),\n  data: function data() {\n    return {\n      ifLike: false,\n      likeColor: 'black',\n      cartCount: '',\n      showSku: false,\n      sku: {\n        tree: [],\n        list: [],\n        price: '0',\n        // 默认价格（单位元）\n        stock_num: 20,\n        // 商品总库存\n        collection_id: 0,\n        // 无规格商品 skuId 取 collection_id，否则取所选 sku 组合对应的 id\n        none_sku: false,\n        // 是否无规格商品\n        hide_stock: false // 是否隐藏剩余库存\n      },\n\n      offline: false,\n      goods: {\n        name: '',\n        price: 0,\n        express: '免运费',\n        remain: 0,\n        thumb: []\n      }\n    };\n  },\n  created: function created() {\n    this.init();\n  },\n  computed: {},\n  methods: {\n    init: function init() {\n      var _this = this;\n      var id = this.$route.params.id;\n      _goods.default.getGoods(id).then(function (response) {\n        var goods = response.data.goods;\n        _this.offline = !goods.isOnSale;\n        var sku = response.data.sku;\n        sku.price = (sku.price / 100).toFixed(2);\n        _this.sku = sku;\n        goods.thumb = new Array();\n        goods.picture = baseApi + '/file/getImgStream?idFile=' + goods.pic;\n        var gallery = goods.gallery.split(',');\n        for (var index in gallery) {\n          goods.thumb.push(baseApi + '/file/getImgStream?idFile=' + gallery[index]);\n        }\n        _this.goods = goods;\n        var user = _storage.default.getUser();\n        if (user.nickName) {\n          //获取当前用户购物车商品数量\n          _cart.default.count().then(function (response) {\n            _this.cartCount = response.data === 0 ? '' : response.data;\n          }).catch(function (err) {});\n          //判断当前用户是否收藏该产品\n          _favorite.default.ifLike(_this.goods.id).then(function (response) {\n            if (response.data === true) {\n              _this.likeColor = 'red';\n              _this.ifLike = true;\n            }\n          }).catch(function (err) {});\n        }\n      }).catch(function (err) {\n        console.log('err', err);\n        (0, _toast.default)(err);\n      });\n    },\n    toHome: function toHome() {\n      this.$router.push('/index');\n    },\n    formatPrice: function formatPrice() {\n      return '¥' + (this.goods.price / 100).toFixed(2);\n    },\n    goToCart: function goToCart() {\n      this.$router.push('/cart');\n    },\n    addCart: function addCart() {\n      this.showSku = true;\n    },\n    buy: function buy() {\n      this.showSku = true;\n    },\n    sorry: function sorry() {\n      (0, _toast.default)('敬请期待');\n    },\n    like: function like() {\n      var _this2 = this;\n      if (this.ifLike === false) {\n        _favorite.default.add(this.goods.id).then(function (response) {\n          (0, _toast.default)('Collection Success');\n          _this2.ifLike = true;\n          _this2.likeColor = 'red';\n        });\n      } else {\n        _favorite.default.dislike(this.goods.id).then(function (response) {\n          (0, _toast.default)('Cancellation success');\n          _this2.ifLike = false;\n          _this2.likeColor = 'black';\n        });\n      }\n    },\n    onBuyClicked: function onBuyClicked(skuData) {\n      var _this3 = this;\n      var cartData = {\n        idGoods: skuData.goodsId,\n        idSku: this.sku.none_sku ? '' : skuData.selectedSkuComb.id,\n        count: skuData.selectedNum\n      };\n      _cart.default.add(cartData).then(function (response) {\n        _this3.$router.push('/cart');\n        _this3.showSku = false;\n      });\n    },\n    onAddCartClicked: function onAddCartClicked(skuData) {\n      var _this4 = this;\n      var cartData = {\n        idGoods: skuData.goodsId,\n        idSku: this.sku.none_sku ? '' : skuData.selectedSkuComb.id,\n        count: skuData.selectedNum\n      };\n      _cart.default.add(cartData).then(function (response) {\n        console.log(response);\n        _toast.default.success('Added to cart');\n        _this4.showSku = false;\n        _this4.cartCount += response.data;\n      });\n    }\n  }\n};\nexports.default = _default;",null]}