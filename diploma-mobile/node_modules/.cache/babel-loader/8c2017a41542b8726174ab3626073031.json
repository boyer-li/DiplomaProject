{"remainingRequest":"D:\\Java\\ideahome\\DiplomaProject\\diploma-mobile\\node_modules\\babel-loader\\lib\\index.js!D:\\Java\\ideahome\\DiplomaProject\\diploma-mobile\\src\\view\\order\\payment\\payment.js?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Java\\ideahome\\DiplomaProject\\diploma-mobile\\src\\view\\order\\payment\\payment.js","mtime":1687470077509},{"path":"D:\\Java\\ideahome\\DiplomaProject\\diploma-mobile\\babel.config.js","mtime":1685539516317},{"path":"D:\\Java\\ideahome\\DiplomaProject\\diploma-mobile\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1685539517946},{"path":"D:\\Java\\ideahome\\DiplomaProject\\diploma-mobile\\node_modules\\babel-loader\\lib\\index.js","mtime":1685539517779}],"contextDependencies":[],"result":["\"use strict\";\n\nvar _interopRequireDefault = require(\"D:/Java/ideahome/DiplomaProject/diploma-mobile/node_modules/@babel/runtime/helpers/interopRequireDefault.js\");\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _defineProperty2 = _interopRequireDefault(require(\"D:/Java/ideahome/DiplomaProject/diploma-mobile/node_modules/@babel/runtime/helpers/defineProperty.js\"));\nrequire(\"vant/es/toast/style\");\nvar _toast = _interopRequireDefault(require(\"vant/es/toast\"));\nrequire(\"vant/es/button/style\");\nvar _button = _interopRequireDefault(require(\"vant/es/button\"));\nrequire(\"vant/es/radio/style\");\nvar _radio = _interopRequireDefault(require(\"vant/es/radio\"));\nrequire(\"vant/es/radio-group/style\");\nvar _radioGroup = _interopRequireDefault(require(\"vant/es/radio-group\"));\nrequire(\"vant/es/cell-group/style\");\nvar _cellGroup = _interopRequireDefault(require(\"vant/es/cell-group\"));\nrequire(\"vant/es/cell/style\");\nvar _cell = _interopRequireDefault(require(\"vant/es/cell\"));\nrequire(\"vant/es/nav-bar/style\");\nvar _navBar = _interopRequireDefault(require(\"vant/es/nav-bar\"));\nvar _pay = _interopRequireDefault(require(\"@/api/pay\"));\nvar _weixinJsSdk = _interopRequireDefault(require(\"weixin-js-sdk\"));\nvar _components;\nvar _default = {\n  components: (_components = {}, (0, _defineProperty2.default)(_components, _navBar.default.name, _navBar.default), (0, _defineProperty2.default)(_components, _cell.default.name, _cell.default), (0, _defineProperty2.default)(_components, _cellGroup.default.name, _cellGroup.default), (0, _defineProperty2.default)(_components, _radioGroup.default.name, _radioGroup.default), (0, _defineProperty2.default)(_components, _radio.default.name, _radio.default), (0, _defineProperty2.default)(_components, _button.default.name, _button.default), (0, _defineProperty2.default)(_components, _toast.default.name, _toast.default), _components),\n  data: function data() {\n    return {\n      order: {},\n      payType: 'wxpay'\n    };\n  },\n  mounted: function mounted() {\n    this.init();\n  },\n  computed: {},\n  methods: {\n    init: function init() {\n      var orderSn = this.$route.query.orderSn;\n      var totalPrice = this.$route.query.totalPrice;\n      this.order = {\n        orderSn: orderSn,\n        totalPrice: totalPrice\n      };\n    },\n    pay: function pay() {\n      if (this.payType === 'wxpay') {\n        this.wxPrepare();\n      } else {\n        (0, _toast.default)('Alipay payment docking in progress...');\n      }\n    },\n    formatPrice: function formatPrice(price) {\n      return (price / 100).toFixed(2);\n    },\n    wxPrepare: function wxPrepare() {\n      var _this = this;\n      _pay.default.wxPrepare({\n        orderSn: this.order.orderSn\n      }).then(function (res) {\n        // 存储微信支付数据data\n        var data = res.data;\n        //函数为分装过得  (就是调用微信支付)\n        _this.wxPay({\n          appId: data.appId,\n          nonceStr: data.nonceStr,\n          package: data.packageValue,\n          paySign: data.paySign,\n          signType: data.signType,\n          timeStamp: data.timeStamp\n        });\n      }).catch(function (err) {\n        (0, _toast.default)(err);\n      });\n    },\n    wxPay: function wxPay() {\n      //获取后台传入的数据\n      /*            let appId = data.appId\r\n                  let timestamp = data.timeStamp\r\n                  let nonceStr = data.nonceStr\r\n                  let signature = data.signature\r\n                  let packageValue = data.package\r\n                  let paySign = data.paySign\r\n                  let signType = data.signType*/\n      var that = this;\n      that.$router.push('/payment/callback/' + that.order.orderSn);\n\n      /* //下面要发起微信支付了\r\n       wx.config({\r\n           debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。\r\n           appId: appId, // 必填，公众号的唯一标识\r\n           timestamp: timestamp, // 必填，生成签名的时间戳\r\n           nonceStr: nonceStr, // 必填，生成签名的随机串\r\n           signature: signature, // 必填，签名，见附录1\r\n           jsApiList: ['chooseWXPay'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2\r\n       })\r\n       wx.ready(function () {\r\n           wx.chooseWXPay({\r\n               timestamp: timestamp, // 支付签名时间戳，注意微信jssdk中的所有使用timestamp字段均为小写。但最新版的支付后台生成签名使用的timeStamp字段名需大写其中的S字符\r\n               nonceStr: nonceStr, // 支付签名随机串，不长于 32 位\r\n               package: packageValue, // 统一支付接口返回的prepay_id参数值，提交格式如：prepay_id=***）\r\n               signType: signType, // 签名方式，默认为'SHA1'，使用新版支付需传入'MD5'\r\n               paySign: paySign, // 支付签名\r\n               success: function (res) {\r\n                   // 支付成功后的回调函数\r\n                   that.$router.push('/payment/callback/'+that.order.orderSn)\r\n               },\r\n               fail: function (res) {\r\n                   //失败回调函数\r\n                   Toast('支付失败')\r\n               }\r\n           })\r\n       })\r\n       wx.error(function (res) {\r\n           console.log('微信支付失败',res)\r\n           Toast('支付失败')\r\n           // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。\r\n           /!*alert(\"config信息验证失败\")*!/\r\n       })*/\n    }\n  }\n};\nexports.default = _default;",null]}